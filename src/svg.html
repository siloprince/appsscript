<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <base target="_top">
</head>

<body>
  種別:
  <select id="type" name="type" style="font-size:11pt;">
      <option value="line">線分</option>
      <option value="lattice_sq">正方格子</option>
      <option value="lattice_tr">三角形格子</option>
      <option value="lattice_hx">六角形格子</option>
    </select> x: <input size="2" id="xval" readonly="readonly" style="border:none;font-size:11pt;">
  <input type="range" name="xrange" id="xrange" value="2" min="1" max="25"> y: <input size="2" id="yval" readonly="readonly"
    style="border:none;font-size:11pt;">
  <input type="range" name="yrange" id="yrange" value="1" min="1" max="10" disabled="disabled">
  <input type="checkbox" name="boundary">境界有り

  <script type="text/javascript">
    var config = {
      max: 25,
      range: {
        x: document.querySelector("input#xrange"),
        y: document.querySelector("input#yrange"),
      },
      val: {
        x: document.querySelector("input#xval"),
        y: document.querySelector("input#yval")
      },
      margin: {
        x: 10,
        y: 10
      }
    };
    setup(config.range, config.val, true);
    setup(config.range, config.val, false);

    function drawGraph(xval, yval) {
      /*
      var svg = ['<svg>'];
      for(var x=0;x<xval;x++){
        for(var y=0;y<yval;y++)
          var cx = config.xx;
          var cy = y;
          svg.push('<circle cx="'+cx+'" cy="'+cy+'" r="3"/>');
        }
      }
      svg.push('</svg>>);
      document.currentScript.insertAdjacentHTML('afterend', svg.join(''));
      */
    }

    function setup(range, val, wzflip) {
      var wrange, zrange, wval, zval;
      if (!wzflip) {
        wrange = range.x;
        zrange = range.y;
        wval = val.x;
        zval = val.y;
      } else {
        wrange = range.y;
        zrange = range.x;
        wval = val.y;
        zval = val.x;
      }
      wrange.setAttribute('max', config.max);
      wval.setAttribute('value', wrange.getAttribute('value'));
      wrange.addEventListener(
        'change',
        function (ev) {
          var wvalue = parseInt(ev.target.value, 10);
          var zvalue = parseInt(zrange.getAttribute('value'), 10);
          var wzvalue = wvalue * zvalue;
          if (wzvalue > config.max) {
            for (var w = wvalue - 1; w >= 2; w--) {
              for (var z = zvalue; z >= 2; z--) {
                var _wzvalue = w * z;
                if (_wzvalue <= config.max) {
                  wrange.getAttribute('value', w);
                  zrange.getAttribute('value', z);
                  wval.setAttribute('value', w);
                  zval.setAttribute('value', z);
                  return;
                }
              }
            }
            zvalue = 2;
            wvalue = Math.floor(config.max / zvalue);
          }
          wval.setAttribute('value', wvalue);
          zval.setAttribute('value', zvalue);
          if (!wzflip) {
            drawGraph(wvalue, zvalue);
          } else {
            drawGraph(zvalue, wvalue);
          }
        }, false
      );
    }
    document.querySelector("select#type").addEventListener(
      'change',
      function (ev) {
        var value = ev.target.value;
        var yrange = config.range.y;
        var yval = config.val.y;
        if (value === 'line') {
          yrange.setAttribute('value', 1);
          yval.setAttribute('value', 1)
          yrange.setAttribute('disabled', 'disabled');
        } else {
          yrange.removeAttribute('disabled');
          yrange.setAttribute('value', 2);
          yval.setAttribute('value', 2)
        }
      }, false
    );
  </script>
</body>

</html>